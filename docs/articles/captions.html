<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Captions and references • officedown</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Captions and references">
<meta property="og:description" content="officedown">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">officedown</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/yaml.html">YAML header</a>
</li>
<li>
  <a href="../articles/captions.html">Captions and references</a>
</li>
<li>
  <a href="../articles/officer.html">officer support</a>
</li>
<li>
  <a href="../articles/tables.html">data.frame printing</a>
</li>
<li>
  <a href="../articles/lists.html">Lists</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Function reference</a>
</li>
<li>
  <a href="https://github.com/davidgohel/officedown">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="captions_files/header-attrs-2.3/header-attrs.js"></script><script src="captions_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Captions and references</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/davidgohel/officedown/blob/master/vignettes/captions.Rmd"><code>vignettes/captions.Rmd</code></a></small>
      <div class="hidden name"><code>captions.Rmd</code></div>

    </div>

    
    
<style type="text/css">
.medium > p > img {
  width: 50%;
}
.unpeugrand > p > img {
  width: 85%;
}
</style>
<div id="set-caption-label" class="section level2">
<h2 class="hasAnchor">
<a href="#set-caption-label" class="anchor"></a>Set caption label</h2>
<blockquote>
<p>Use knitr chunk options <code>fig.cap</code> or <code>tab.cap</code> to specify the label of the caption. If a table, caption will be added before the table, if a graphic, caption will be added after the graphic.</p>
</blockquote>
<pre><code>```{r fig.cap="figure caption"}
plot(1:12)
```

```{r tab.cap="table caption"}
head(iris)
```</code></pre>
<div class="unpeugrand">
<p><img src="../man/figures/CR-r-chunk.png"></p>
</div>
<p>It will produce an auto-numbered caption associated with a bookmark:</p>
<div class="medium">
<p><img src="../man/figures/CR-caption-bookmark.png"></p>
</div>
</div>
<div id="cross-references" class="section level2">
<h2 class="hasAnchor">
<a href="#cross-references" class="anchor"></a>Cross-references</h2>
<p>Cross-referencing is particularly interesting when using <code>{bookdown}</code>. Bookdown references and captions are not always satisfying some organizations requirements that impose usage of computed numbered captions and references to them for Word documents. <code>{officedown}</code> bring this feature: caption are autonumbered and a bookmark is set on the chunk containing the number; cross-references are Word references hyperlinked to the captions they are related to.</p>
<p>The functionality will allow the editing of Word documents produced with respect of different references or numbered captions. This is particulary useful when the document is modified in its structure (chapters moved, graphics added manually) or integrated into another Word document.</p>
<pre><code>This is a linked reference to a figure: \@ref(fig:tsplot)</code></pre>
<p><img src="../man/figures/CR-reference_hover.png"></p>
<p>To refer to simple document id, use syntax <code>\@ref(an_id)</code>:</p>
</div>
<div id="lists-of-figures-and-tables" class="section level2">
<h2 class="hasAnchor">
<a href="#lists-of-figures-and-tables" class="anchor"></a>Lists of Figures and Tables</h2>
<p>You can list and organize the figures or tables in a Word document by creating a table of figures, much like a table of contents.</p>
<div id="using-stylename" class="section level3">
<h3 class="hasAnchor">
<a href="#using-stylename" class="anchor"></a>Using stylename</h3>
<p>R Markdown uses the Word paragraph style “Image Caption” for graphic captions. To my knowledge, there is no official feature for table captions and therefore no style associated with table captions. Word, on the other hand, only uses a paragraph style called “Caption” whether the caption is relative to a graph, a table or an equation. Note that this style name is specific to each country.</p>
<p>The choice that has been made with <code>officedown</code> is to let you apply one or different styles for table and graph captions. Default style for graph captions is “Image Caption” and default style for table captions is “Table Caption” (which is also available in R Markdown (and pandoc) Word template.</p>
<p>Create a list of figures with function <code>block_toc</code> or by using officedown chunk <code>&lt;!---BLOCK_TOC{...}---&gt;</code></p>
<p>If you used two different styles for table and figures captions, use <code>block_toc</code> with argument <code>style</code> set to the caption style name.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu">block_toc</span>(<span class="kw">style</span> <span class="kw">=</span> <span class="st">"Table Caption"</span>)</pre></body></html></div>
<p>OR</p>
<p><code>&lt;!---BLOCK_TOC{style: "Table Caption"}---&gt;</code></p>
</div>
<div id="using-sequence-identifier" class="section level3">
<h3 class="hasAnchor">
<a href="#using-sequence-identifier" class="anchor"></a>Using sequence identifier</h3>
<p>You might have to (or want to) use only one single style for table and graphic captions and need to generate one table of contents for tables and one for charts.</p>
<p>In that case use <code>block_toc</code> with argument <code>seq_id</code> set by default to <code>tab</code> for table captions and <code>fig</code> for figure captions.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu">block_toc</span>(<span class="kw">seq_id</span> <span class="kw">=</span> <span class="st">"tab"</span>)</pre></body></html></div>
<p>OR</p>
<p><code>&lt;!---BLOCK_TOC{seq_id: "fig"}---&gt;</code></p>
<div id="what-is-that-sequence-id" class="section level4">
<h4 class="hasAnchor">
<a href="#what-is-that-sequence-id" class="anchor"></a>What is that sequence id?</h4>
<p>When using Word, you can add a list of figures or tables (go to the “References” tab and select “Insert Table of Figures”). By default, you won’t see your sequence in the menu because Word is storing locally 3 sequence names in your profile (for tables, figures and eequation). Although not recommended, you can change <code>tab.lp</code> to <code>Tabelle</code> (or <code>Tableau</code>) and benefit from the feature manually from Word. Again, this is not recommended as it will force you to update that value for little gain.</p>
</div>
</div>
</div>
<div id="sequence-options" class="section level2">
<h2 class="hasAnchor">
<a href="#sequence-options" class="anchor"></a>Sequence options</h2>
<p>Legends for tables and figures can be configured as required. We have chosen default values for the options that are classic in terms of usage but these values correspond to the English language. If you are writing in Spanish, German, or another language, you probably want to change these values to match your language.</p>
<p>The values to be configured for the tables are the following:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">tables</span><span class="kw">:</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="at">  </span><span class="fu">caption</span><span class="kw">:</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="at">    </span><span class="fu">style</span><span class="kw">:</span><span class="at"> Table Caption</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="at">    </span><span class="fu">pre</span><span class="kw">:</span><span class="at"> </span><span class="st">'Table '</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="at">    </span><span class="fu">sep</span><span class="kw">:</span><span class="at"> </span><span class="st">': '</span></span></code></pre></div>
<p>These values can also be altered via the function <code>knitr::opts_chunk$set()</code>.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span>$<span class="fu">set</span>(
  <span class="kw">tab.cap.style</span> <span class="kw">=</span> <span class="st">"Table Caption"</span>,
  <span class="kw">tab.cap.pre</span> <span class="kw">=</span> <span class="st">"Table "</span>,
  <span class="kw">tab.cap.sep</span> <span class="kw">=</span> <span class="st">": "</span>,
  )</pre></body></html></div>
<p>The values to be configured for the figures are the following:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">plots</span><span class="kw">:</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="at">  </span><span class="fu">caption</span><span class="kw">:</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="at">    </span><span class="fu">style</span><span class="kw">:</span><span class="at"> Image Caption</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="at">    </span><span class="fu">pre</span><span class="kw">:</span><span class="at"> </span><span class="st">'Figure '</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="at">    </span><span class="fu">sep</span><span class="kw">:</span><span class="at"> </span><span class="st">': '</span></span></code></pre></div>
<p>These values can also be altered via the function <code>knitr::opts_chunk$set()</code>.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span>$<span class="fu">set</span>(
  <span class="kw">fig.cap.style</span> <span class="kw">=</span> <span class="st">"Image Caption"</span>,
  <span class="kw">fig.cap.pre</span> <span class="kw">=</span> <span class="st">"Figure "</span>,
  <span class="kw">fig.cap.sep</span> <span class="kw">=</span> <span class="st">": "</span>,
  )</pre></body></html></div>
<p>You can also use at any moment knitr chunk options:</p>
<pre><code>```{r fig.cap="figure caption", fig.cap.style="Image Caption"}
plot(1:12)
```

```{r tab.cap="table caption", tab.cap.style="Table Caption"}
head(iris)
```</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><link href="../ardata.css" rel="stylesheet">
<div class="author">
  <p>Version 0.2.0 - Developed by David Gohel, Institut für Qualitätssicherung und Transparenz im Gesundheitswesen, Noam Ross - proudly brought to you by <a href="http://www.ardata.fr"><img alt="ardata" src="../ardata-logo.svg" style="vertical-align:middle;height:24px;"></a>
  </p>
</div>
<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48354045-1', 'auto');
  ga('send', 'pageview');
</script></footer>
</div>

  


  </body>
</html>
